<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Maki (maki.Maki)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">maki</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Maki</span></h1></header><h2>Maki: Persistent Incremental Computations</h2><p>Maki is a system for memoizing costly OCaml functions using the disk.
It requires the functions to be <b>pure</b>, that is, to always return
the same result given that the set of <b>dependencies</b> declared by
the function doesn't change.</p><p><b>status: experimental</b></p><p>This module is not thread-safe.</p><div class="spec type" id="type-or_error"><a href="#type-or_error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a or_error</code><code><span class="keyword"> = </span>(<span class="type-var">'a</span>, string) Result.result</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-lwt_or_error"><a href="#type-lwt_or_error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a lwt_or_error</code><code><span class="keyword"> = </span><span class="type-var">'a</span> <a href="index.html#type-or_error">or_error</a> Lwt.t</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-printer"><a href="#type-printer" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a printer</code><code><span class="keyword"> = </span>Format.formatter <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> unit</code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-error"><a href="#val-error" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>error : string <span class="keyword">&#8209;&gt;</span> <span class="type-var">_</span> <a href="index.html#type-or_error">or_error</a></code></div><div class="doc"></div></div><div class="spec val" id="val-errorf"><a href="#val-errorf" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>errorf : (<span class="type-var">'a</span>, Format.formatter, unit, <span class="type-var">'b</span> <a href="index.html#type-or_error">or_error</a>) Pervasives.format4 <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span></code></div><div class="doc"></div></div><h3>Basic types</h3><div class="spec type" id="type-path"><a href="#type-path" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>path</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-program"><a href="#type-program" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>program</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-time"><a href="#type-time" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>time</code><code><span class="keyword"> = </span>float</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-hash"><a href="#type-hash" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>hash</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-encoded_value"><a href="#type-encoded_value" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>encoded_value</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"></div></div><div class="spec module" id="module-E"><a href="#module-E" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="E/index.html">E</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><h3>Error Handling</h3></div></div><h3>Controlling Parallelism</h3><div class="spec module" id="module-Limit"><a href="#module-Limit" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Limit/index.html">Limit</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Codec"><a href="#module-Codec" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Codec/index.html">Codec</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><h3>Codec</h3></div></div><h3>Persistent storage</h3><p>We use a generic interface for persistent storage, in the form of a
dictionary <code class="code">string -&gt; string</code>. The default storage just uses
one file per pair.</p><div class="spec module" id="module-Storage"><a href="#module-Storage" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Storage/index.html">Storage</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h3>Time Utils</h3><div class="spec module" id="module-Time"><a href="#module-Time" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Time/index.html">Time</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Lifetime"><a href="#module-Lifetime" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Lifetime/index.html">Lifetime</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><h3>lifetime for a value on disk</h3></div></div><h3>Values Stored on Disk</h3><div class="spec module" id="module-File_ref"><a href="#module-File_ref" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="File_ref/index.html">File_ref</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Program_ref"><a href="#module-Program_ref" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Program_ref/index.html">Program_ref</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Ref"><a href="#module-Ref" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Ref/index.html">Ref</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><div class="h7">Reference to On-Disk Value</div></div></div><h3>Hash function</h3><p>A cryptographic hash function used to map objects to (probably) unique keys</p><div class="spec module" id="module-Hash"><a href="#module-Hash" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Hash/index.html">Hash</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h3>Memoized Functions</h3><p>This is the heart of the library: a wrapper around <b>pure</b> functions
from <a href="Arg/index.html">Arg</a> arguments to a <a href="Codec/index.html">Codec</a>-aware type. Such functions
are supposed to always return the same value given the same arguments
and dependencies (a typical dependency is an external program that
might have several version).</p><p>The <a href="index.html#val-call">call</a> function is used to actually evaluate a wrapped function,
or return its memoized result if the computation was done already.</p><p>We need to name functions because, from one execution to another,
the results of a function call must be stored on disk. Names are used
to map function calls to their result. If two different functions
share the same name (even across programs), the results will be
unpredictable.</p><h4>High-Level API</h4><div class="spec module" id="module-Fun"><a href="#module-Fun" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Fun/index.html">Fun</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec val" id="val-return_ok"><a href="#val-return_ok" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>return_ok : <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-return_fail"><a href="#val-return_fail" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>return_fail : string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-mk1"><a href="#val-mk1" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mk1 : (name:string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="Codec/index.html#type-t">Codec.t</a> <span class="keyword">&#8209;&gt;</span> f:(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="index.html#type-or_error">or_error</a> Lwt.t)<span class="keyword"> as </span>f <span class="keyword">&#8209;&gt;</span> <span class="type-var">'f</span>) <a href="Fun/index.html#type-call_wrap">Fun.call_wrap</a></code></div><div class="doc"><p><code class="code">mk1 ~name h codec ~f</code> behaves like the unary function <code class="code">f : 'a -&gt; 'ret</code>
but uses the hash function <code class="code">h</code> to hash arguments, and <code class="code">codec</code> to
save/restore values from the cache when <code class="code">f</code> has already been evaluated
on a given value.</p><ul class="at-tag"><li><p><span class="at-tag parameter">Parameter</span> <span class="module-path">name</span>: is used to distinguish calls to <code class="code">f</code> from calls to other
functions that have the same signature.</p><p>Example: memoizing a recursive function:
</p><pre><code class="code">let fib =
  let rec fib = lazy Maki.(
      mk1 ~name:&quot;fib&quot; Hash.int Codec.int ~lifetime:Lifetime.one_minute
        ~f:(fun x -&gt; if x &lt;= 1
          then return_ok 1
          else E.(Lazy.force fib (x-1) &gt;&gt;= fun x1 -&gt;
              Lazy.force fib (x-2) &gt;|= fun x2 -&gt; x1+x2))
    ) in
  Lazy.force fib;;

fib 42 ;;
(* returns [Ok 42] *)</code></pre></li></ul></div></div><div class="spec val" id="val-mk2"><a href="#val-mk2" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mk2 : (name:string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="Codec/index.html#type-t">Codec.t</a> <span class="keyword">&#8209;&gt;</span> f:(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="index.html#type-or_error">or_error</a> Lwt.t)<span class="keyword"> as </span>f <span class="keyword">&#8209;&gt;</span> <span class="type-var">'f</span>) <a href="Fun/index.html#type-call_wrap">Fun.call_wrap</a></code></div><div class="doc"></div></div><div class="spec val" id="val-mk3"><a href="#val-mk3" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mk3 : (name:string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'c</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="Codec/index.html#type-t">Codec.t</a> <span class="keyword">&#8209;&gt;</span> f:(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'c</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="index.html#type-or_error">or_error</a> Lwt.t)<span class="keyword"> as </span>f <span class="keyword">&#8209;&gt;</span> <span class="type-var">'f</span>) <a href="Fun/index.html#type-call_wrap">Fun.call_wrap</a></code></div><div class="doc"></div></div><div class="spec val" id="val-mk4"><a href="#val-mk4" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mk4 : (name:string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'c</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'d</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="Codec/index.html#type-t">Codec.t</a> <span class="keyword">&#8209;&gt;</span> f:(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'c</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'d</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="index.html#type-or_error">or_error</a> Lwt.t)<span class="keyword"> as </span>f <span class="keyword">&#8209;&gt;</span> <span class="type-var">'f</span>) <a href="Fun/index.html#type-call_wrap">Fun.call_wrap</a></code></div><div class="doc"></div></div><div class="spec val" id="val-mk5"><a href="#val-mk5" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mk5 : (name:string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'c</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'d</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'e</span> <a href="Hash/index.html#type-t">Hash.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="Codec/index.html#type-t">Codec.t</a> <span class="keyword">&#8209;&gt;</span> f:(<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'c</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'d</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'e</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'ret</span> <a href="index.html#type-or_error">or_error</a> Lwt.t)<span class="keyword"> as </span>f <span class="keyword">&#8209;&gt;</span> <span class="type-var">'f</span>) <a href="Fun/index.html#type-call_wrap">Fun.call_wrap</a></code></div><div class="doc"></div></div><h4>Low-Level API</h4><div class="spec module" id="module-Arg"><a href="#module-Arg" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Arg/index.html">Arg</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p>To memoize a function, Maki must be able to hash the function's input
arguments. Arguments that hash to the same value are considered
identical. We use a cryptographic hash to ensure that the probability
of collisions is astronomically low.</p></div></div><div class="spec val" id="val-call"><a href="#val-call" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>call : ?&#8288;bypass:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;storage:<a href="Storage/index.html#type-t">Storage.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;lifetime:<a href="Lifetime/index.html#type-t">Lifetime.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;limit:<a href="Limit/index.html#type-t">Limit.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;tags:string list <span class="keyword">&#8209;&gt;</span> name:string <span class="keyword">&#8209;&gt;</span> args:<a href="Arg/index.html#type-t">Arg.t</a> list <span class="keyword">&#8209;&gt;</span> returning:<span class="type-var">'a</span> <a href="Codec/index.html#type-t">Codec.t</a> <span class="keyword">&#8209;&gt;</span> (unit <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-or_error">or_error</a> Lwt.t) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"><p>Call the function iff its result has not been cached yet</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">bypass</span>: if true, then cache is disabled</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">storage</span>: the storage used for caching values
(default <code class="code">Storage.get_default ()</code>)</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">lifetime</span>: how long to keep the cached value (default: <code class="code">`CanDrop</code>)</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">limit</span>: if given, <code class="code">call</code> will acquire a handle from <code class="code">limit</code> before
calling the (potentially costly) function</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">name</span>: the name of the function, should be unique!</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">deps</span>: the dependencies (arguments) of the function</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">returning</span>: how to encode/decode the result on disk</li></ul></div></div><div class="spec val" id="val-call_pure"><a href="#val-call_pure" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>call_pure : ?&#8288;bypass:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;storage:<a href="Storage/index.html#type-t">Storage.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;lifetime:<a href="Lifetime/index.html#type-t">Lifetime.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;limit:<a href="Limit/index.html#type-t">Limit.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;tags:string list <span class="keyword">&#8209;&gt;</span> name:string <span class="keyword">&#8209;&gt;</span> args:<a href="Arg/index.html#type-t">Arg.t</a> list <span class="keyword">&#8209;&gt;</span> returning:<span class="type-var">'a</span> <a href="Codec/index.html#type-t">Codec.t</a> <span class="keyword">&#8209;&gt;</span> (unit <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> Lwt.t) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"></div></div><h3>GC</h3><p>Garbage Collection for the stored values. It needs to be called
explicitely</p><div class="spec module" id="module-GC_info"><a href="#module-GC_info" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="GC_info/index.html">GC_info</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-On_disk_record"><a href="#module-On_disk_record" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="On_disk_record/index.html">On_disk_record</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-GC"><a href="#module-GC" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="GC/index.html">GC</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h3>Utils</h3><div class="spec module" id="module-Util"><a href="#module-Util" class="anchor"></a><div class="def module"><code><span class="keyword">module </span>Util = <a href="../Maki__/index.html#module-Maki_utils">Maki__.Maki_utils</a></code></div><div class="doc"></div></div><div class="spec val" id="val-last_mtime"><a href="#val-last_mtime" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>last_mtime : <a href="index.html#type-path">path</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-time">time</a> <a href="index.html#type-or_error">or_error</a></code></div><div class="doc"><p>Last modification time of the file</p></div></div><div class="spec val" id="val-sha1"><a href="#val-sha1" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>sha1 : <a href="index.html#type-path">path</a> <span class="keyword">&#8209;&gt;</span> string <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"><p><code class="code">sha1 f</code> hashes the file <code class="code">f</code></p></div></div><div class="spec val" id="val-sha1_of_string"><a href="#val-sha1_of_string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>sha1_of_string : string <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>hash the given string</p></div></div><div class="spec val" id="val-abspath"><a href="#val-abspath" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>abspath : <a href="index.html#type-path">path</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-path">path</a></code></div><div class="doc"><p>Make the path absolute</p></div></div><div class="spec val" id="val-shell"><a href="#val-shell" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>shell : ?&#8288;timeout:float <span class="keyword">&#8209;&gt;</span> ?&#8288;stdin:string <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string<span class="keyword"> * </span>int) <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"><p><code class="code">shell cmd</code> runs the command <code class="code">cmd</code> and
returns <code class="code">stdout, sterr, errcode</code>.</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">stdin</span>: optional input to the sub-process</li></ul></div></div><div class="spec val" id="val-shellf"><a href="#val-shellf" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>shellf : ?&#8288;timeout:float <span class="keyword">&#8209;&gt;</span> ?&#8288;stdin:string <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span>, Format.formatter, unit, (string<span class="keyword"> * </span>string<span class="keyword"> * </span>int) <a href="index.html#type-or_error">or_error</a> Lwt.t) Pervasives.format4 <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span></code></div><div class="doc"><p>Same as <a href="index.html#val-shell">shell</a> but with a format string. Careful with escaping!</p></div></div><div class="spec val" id="val-read_file"><a href="#val-read_file" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>read_file : <a href="File_ref/index.html#type-t">File_ref.t</a> <span class="keyword">&#8209;&gt;</span> string <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"><p>Read the content of the file</p></div></div><div class="spec val" id="val-walk"><a href="#val-walk" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>walk : ?&#8288;filter:(<a href="index.html#type-path">path</a> <span class="keyword">&#8209;&gt;</span> bool) <span class="keyword">&#8209;&gt;</span> ?&#8288;recursive:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;which:[ `File | `Dir ] list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-path">path</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-path">path</a> list <a href="index.html#type-or_error">or_error</a> Lwt.t</code></div><div class="doc"><p><code class="code">walk dir</code> traverses the directory and yields
its content, by <b>absolute</b> path.</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">which</span>: filters on the type of the content</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">recursive</span>: if true, walks into subdirectories too</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">filter</span>: filters the absolute path of objects
and yields only these which satisfy the predicate</li></ul></div></div><h3>Logging</h3><div class="spec module" id="module-Log"><a href="#module-Log" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Log/index.html">Log</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div></body></html>